<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: cmdsLocal.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: cmdsLocal.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module */

const labels = require('./labels');
const storage = require('./storage');
const audio = require('./audio');
const messenger = require('./messenger');
const commandHandler = require('./commandHandler');
const textTools = require('./textTools');
const domManipulator = require('./domManipulator');

/**
 * @static
 * @type {Object}
 */
const commands = {};

/**
 * Reloads the page
 * @private
 */
function refreshApp() {
  window.location.reload();
}

commands.reboot = {
  func: () => {
    refreshApp();
  },
  accessLevel: 1,
  category: 'basic',
};

commands.alias = {
  func: (phrases) => {
    const aliasName = phrases.shift();
    const sequence = phrases;
    const aliases = storage.getAliases();
    const commandKeys = Object.keys(commands);

    if (aliasName &amp;&amp; sequence &amp;&amp; commandKeys.indexOf(aliasName) === -1) {
      aliases[aliasName] = sequence;
      storage.setAliases(aliases);
    } else if (commandKeys.indexOf(aliasName) > -1) {
      messenger.queueMessage({
        text: [`${aliasName} is a built-in command. You may not override built-in commands`],
        text_se: [`${aliasName} är ett inbyggt kommando. Inbyggda kommandon kan inte ersättas`],
      });
    } else {
      messenger.queueMessage({
        text: [
          'You have to input a name and sequence',
          'Example: alias goodalias msg hello',
        ],
        text_se: [
          'Ni måste skriva in ett namn och sekvens',
          'Exempel: alias goodalias msg hello',
        ],
      });
    }
  },
  accessLevel: 13,
  category: 'basic',
  commandName: 'alias',
};

commands.radio = {
  func: (phrases = []) => {
    if (phrases.length === 0) {
      messenger.queueMessage({
        text: labels.getText('instructions', 'radio'),
      });

      return;
    }

    const channels = storage.getRadioChannels();
    const choice = phrases[0];

    switch (choice) {
      case 'on': {
        if (!phrases[1]) {
          messenger.queueMessage({
            text: labels.getText('instructions', 'radio'),
          });

          break;
        }

        const chosenChannel = phrases[1].toLowerCase();

        if (channels[chosenChannel] &amp;&amp; channels[chosenChannel].url) {
          audio.playAudio({ path: channels[chosenChannel].url, type: 'radio' });
        } else {
          messenger.queueMessage({
            text: labels.getText('instructions', 'radio'),
          });
        }

        break;
      }
      case 'list': {
        messenger.queueMessage({ text: Object.keys(channels).map((channel) => channels[channel].name) });

        break;
      }
      case 'off': {
        audio.resetAudio('radio');

        break;
      }
      default: {
        break;
      }
    }
  },
  visibility: 0,
  accessLevel: 0,
  category: 'basic',
  commandName: 'radio',
  options: {
    on: { description: 'Turn on the radio' },
    list: { description: 'List all channels' },
    off: { description: 'Turn off the radio' },
  },
};

commands.help = {
  func: (phrases) => {
    /**
     * Returns names of all available commands for the user, based on the users access level and the commands visibility
     * @private
     * @returns {string[]} - Names of all available commands for the user
     */
    function getCommands() {
      const allCommands = [];
      // TODO Change from Object.keys for compatibility with older Android
      const keys = commandHandler.getCommands();

      for (let i = 0; i &lt; keys.length; i++) {
        const commandName = keys[i];
        const commandAccessLevel = commandHandler.getCommandAccessLevel(commandName);
        const commandVisibility = commandHandler.getCommandVisibility(commandName);

        if (storage.getAccessLevel() >= commandAccessLevel &amp;&amp; storage.getAccessLevel() >= commandVisibility) {
          allCommands.push(commandName);
        }
      }

      return allCommands.concat(Object.keys(storage.getAliases())).sort();
    }

    /**
     * Sends all available commands as a message to the user
     * @private
     */
    function getAll() {
      const allCommands = getCommands();

      if (storage.getUser() === null) {
        messenger.queueMessage({ text: labels.getText('info', 'useRegister') });
      }

      messenger.queueMessage({
        text: allCommands,
        linkable: true,
      });
    }

    if (undefined === phrases || phrases.length === 0) {
      messenger.queueMessage({ text: textTools.createCommandStart('help').concat(labels.getText('instructions', 'helpExtra')) });
      getAll();
    } else if (phrases.length >= 1) {
      messenger.printHelpMessage(phrases[0]);
    }
  },
  accessLevel: 1,
  category: 'basic',
  commandName: 'help',
  options: {},
};

commands.clear = {
  func: () => {
    domManipulator.clearMainFeed();
  },
  clearAfterUse: true,
  accessLevel: 13,
  category: 'basic',
  commandName: 'clear',
};

commands.settings = {
  func: (phrases = []) => {
    if (phrases.length > 1) {
      const setting = phrases[0];
      const value = phrases[1] === 'on';

      switch (setting) {
        case 'fastmode': {
          storage.setFastMode(value);

          if (value) {
            messenger.queueMessage({ text: labels.getText('info', 'fastModeOn') });
          } else {
            messenger.queueMessage({ text: labels.getText('info', 'fastModeOff') });
          }

          break;
        }
        case 'hiddencursor': {
          storage.shouldHideCursor(value);

          if (value) {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenCursorOn') });
          } else {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenCursorOff') });
          }

          break;
        }
        case 'hiddenmenu': {
          storage.shouldHideMenu(value);

          if (value) {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenMenuOn') });
          } else {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenMenuOff') });
          }

          break;
        }
        case 'hiddencmdinput': {
          storage.shouldHideCmdInput(value);

          if (value) {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenCmdInputOn') });
          } else {
            messenger.queueMessage({ text: labels.getText('info', 'hiddenCmdInputOff') });
          }

          break;
        }
        case 'thinnerview': {
          storage.shouldThinView(value);

          if (value) {
            messenger.queueMessage({ text: labels.getText('info', 'thinnerViewOn') });
          } else {
            messenger.queueMessage({ text: labels.getText('info', 'thinnerViewOff') });
          }

          break;
        }
        default: {
          messenger.queueMessage({ text: labels.getText('errors', 'invalidSetting') });

          break;
        }
      }
    } else {
      messenger.queueMessage({ text: labels.getText('errors', 'settingUsage') });
    }
  },
  accessLevel: 1,
  visibility: 13,
  category: 'admin',
  commandName: 'settings',
};

module.exports = commands;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-audio.html">audio</a></li><li><a href="module-clickHandler.html">clickHandler</a></li><li><a href="module-cmdsAdmin.html">cmdsAdmin</a></li><li><a href="module-cmdsBbr.html">cmdsBbr</a></li><li><a href="module-cmdsChat.html">cmdsChat</a></li><li><a href="module-cmdsInfo.html">cmdsInfo</a></li><li><a href="module-cmdsLocal.html">cmdsLocal</a></li><li><a href="module-cmdsMap.html">cmdsMap</a></li><li><a href="module-cmdsSatellite.html">cmdsSatellite</a></li><li><a href="module-cmdsTeam.html">cmdsTeam</a></li><li><a href="module-cmdsUser.html">cmdsUser</a></li><li><a href="module-cmdsUtility.html">cmdsUtility</a></li><li><a href="module-commandHandler.html">commandHandler</a></li><li><a href="module-domManipulator.html">domManipulator</a></li><li><a href="module-labels.html">labels</a></li><li><a href="module-layoutChanger.html">layoutChanger</a></li><li><a href="module-mapTools.html">mapTools</a></li><li><a href="module-messenger.html">messenger</a></li><li><a href="module-painter.html">painter</a></li><li><a href="module-socketHandler.html">socketHandler</a></li><li><a href="module-storage.html">storage</a></li><li><a href="module-textTools.html">textTools</a></li><li><a href="module-videoPlayer.html">videoPlayer</a></li><li><a href="module-zalgoGenerator.html">zalgoGenerator</a></li></ul><h3>Global</h3><ul><li><a href="global.html#autoCompleteOption">autoCompleteOption</a></li><li><a href="global.html#commandQueue">commandQueue</a></li><li><a href="global.html#commandTime">commandTime</a></li><li><a href="global.html#goFullScreen">goFullScreen</a></li><li><a href="global.html#isScreenOff">isScreenOff</a></li><li><a href="global.html#isTouchDevice">isTouchDevice</a></li><li><a href="global.html#keyPressed">keyPressed</a></li><li><a href="global.html#keyReleased">keyReleased</a></li><li><a href="global.html#lastScreenOff">lastScreenOff</a></li><li><a href="global.html#match">match</a></li><li><a href="global.html#morseSeparator">morseSeparator</a></li><li><a href="global.html#onStartup">onStartup</a></li><li><a href="global.html#onVideoMessage">onVideoMessage</a></li><li><a href="global.html#pausePositionTime">pausePositionTime</a></li><li><a href="global.html#preparePosition">preparePosition</a></li><li><a href="global.html#refocus">refocus</a></li><li><a href="global.html#screenOffIntervalTime">screenOffIntervalTime</a></li><li><a href="global.html#setIntervals">setIntervals</a></li><li><a href="global.html#soundQueue">soundQueue</a></li><li><a href="global.html#watchPositionTime">watchPositionTime</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Tue Jun 21 2016 22:00:47 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
